<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>ممشى الهجر - الواقع المعزز</title>
    
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>

    <style>
        /* تنظيف الصفحة بالكامل */
        body, html {
            margin: 0; padding: 0; overflow: hidden;
            background-color: transparent !important; /* هام جداً: خلفية شفافة */
        }

        /* واجهة المستخدم تطفو فوق الكاميرا */
        #ui-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(15, 23, 42, 0.9); /* خلفية داكنة للبداية فقط */
            z-index: 9999; display: flex; flex-direction: column;
            align-items: center; justify-content: center; color: white; text-align: center;
            transition: opacity 0.5s;
        }

        /* إطار الخريطة */
        .map-box {
            width: 80%; height: 200px; background: #334155;
            border: 2px solid #22d3ee; border-radius: 15px; margin-bottom: 20px;
            display: flex; align-items: center; justify-content: center;
        }

        h1 { color: #22d3ee; margin: 0 0 10px; font-family: 'Tajawal', sans-serif; }
        p { color: #cbd5e1; font-family: 'Tajawal', sans-serif; }

        /* زر البدء */
        button {
            background: #22d3ee; color: #0f172a; border: none; padding: 15px 40px;
            font-size: 18px; font-weight: bold; border-radius: 50px; cursor: pointer;
            margin-top: 20px;
        }

        /* التوقيع */
        .footer { position: absolute; bottom: 20px; color: #94a3b8; font-size: 12px; }

        /* إصلاح مشكلة الكاميرا السوداء */
        .arjs-loader { display: none !important; } 
    </style>
</head>

<body>

    <div id="ui-overlay">
        <div class="map-box">
            <p>خريطة المسار</p>
        </div>
        <h1>ممشى الهجر</h1>
        <p>جولة تفاعلية بالواقع المعزز</p>
        <button onclick="startApp()">ابدأ الجولة</button>
        <div class="footer">تعديل وإنشاء: سامي السمري</div>
    </div>

    <a-scene 
        vr-mode-ui="enabled: false"
        embedded
        arjs="sourceType: webcam; debugUIEnabled: false;"
        renderer="antialias: true; alpha: true;">

        <a-camera gps-camera rotation-reader far="1000"></a-camera>

        <a-entity position="0 0 -3">
            <a-cone color="#22d3ee" position="0 0.5 0" radius-bottom="0.2" radius-top="0" height="0.5" rotation="180 0 0"></a-cone>
            <a-text value="تجربة الشكل" align="center" position="0 1 0" color="white" scale="1.5 1.5 1.5"></a-text>
        </a-entity>


        <a-entity gps-entity-place="latitude: 23.28061; longitude: 56.92604;">
            <a-image src="#img-welcome" scale="2 2 1" look-at="[gps-camera]" position="0 2 0"></a-image>
        </a-entity>

        <a-entity gps-entity-place="latitude: 23.28022167; longitude: 56.92759333;">
            <a-entity position="0 0 0" rotation="0 0 0" animation="property: position; to: 0 0.5 0; dir: alternate; dur: 2000; loop: true">
                 <a-triangle color="#22d3ee" vertex-a="0 0.5 0" vertex-b="-0.25 -0.25 0" vertex-c="0.25 -0.25 0" rotation="-90 0 0"></a-triangle>
            </a-entity>
        </a-entity>

        <a-assets>
            <img id="img-welcome" src="board_welcome.jpg">
            </a-assets>

    </a-scene>

    <script>
        function startApp() {
            // إخفاء الواجهة ببطء
            var ui = document.getElementById('ui-overlay');
            ui.style.opacity = '0';
            setTimeout(function(){ ui.style.display = 'none'; }, 500);

            // نطق المقدمة
            speak();
        }

        function speak() {
            if ('speechSynthesis' in window) {
                var msg = new SpeechSynthesisUtterance("حياكم الله في ممشى الهجر");
                msg.lang = 'ar-SA';
                window.speechSynthesis.speak(msg);
            }
        }
    </script>
</body>
</html>
